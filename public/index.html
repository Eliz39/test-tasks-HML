<DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Newsletter</title>
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="/public/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="wrapper">

        <form class="form" action="/subscribe" method="POST">
            <div class="container ">
                <h2 class="form__title">Novinkový souhrn e-mailem</h2>
                <div class="container__input-flex">
                    <div class="container__input-item">
                        <input type="email" placeholder="E-mail" name="email" class="form__input-email" required>
                    </div>
                    <div class="container__input-item">
                        <input type="submit" value="Přihlásit se k odběru" name="subscribe" class="form__input-submit">
                    </div>
                </div>
                <!-- <div class="container__message hidden"> -->
                    <p class="empty-email hidden">Zadejte vaši e-mailovou adresu</p>
                    <p class="wrong-email hidden">Zadejte platnou e-mailovou adresu</p>
                <!-- </div> -->
            </div>
            <div class="subscribed hidden">
                <p class="subscribed__text">Přihlašení k odběru bylo úspěšné.</p>
            </div>
        </form>

    </div>
<script>
const submitBtn = document.querySelector(".form__input-submit");
const email = document.querySelector(".form__input-email");
const errorEmpty = document.querySelector(".empty-email");
const errorWrong = document.querySelector(".wrong-email");
const succes = document.querySelector(".subscribed");
const container = document.querySelector(".container");

submitBtn.addEventListener("click", (event) => {

    event.preventDefault();

    if(email.value == null || email.value == "") {
        errorEmpty.classList.remove("hidden");
    } else {
        let fetchData = {
            method: "POST",
            body: JSON.stringify({email: email.value, js: true}),
            headers: {"Content-Type":"application/json"}
        }

        fetch("http://localhost:5000/subscribed", fetchData)
            .then(res => {
                if(res.ok) {
                    container.classList.add("hidden");
                    succes.classList.remove("hidden");

                } else {
                    errorEmpty.classList.add("hidden");
                    errorWrong.classList.remove("hidden");
                }
            })
    }
})
</script>
</body>
</html>